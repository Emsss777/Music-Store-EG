<!DOCTYPE html>
<html lang="en" xmlns:sec="http://www.thymeleaf.org/extras/spring-security">

<head>
    <meta charset="UTF-8">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap"
          rel="stylesheet">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" type="text/css" th:href="@{/css/common.css}">
    <link rel="stylesheet" type="text/css" th:href="@{/css/profile.css}">
    <title>My Profile | Music Store</title>
</head>

<body>

<th:block th:replace="~{fragments/header :: site-header}"></th:block>

<main>
    <div class="profile-header">
        <div class="container">
            <h1 class="page-title">My Profile</h1>
            <p class="page-subtitle">Manage your account and preferences</p>
        </div>
    </div>

    <section class="profile-section">
        <div class="container">
            <div class="profile-layout">
                <aside class="profile-sidebar">
                    <div class="profile-nav card">
                        <div class="profile-avatar-section">
                            <div class="profile-avatar">
                                <img th:src="${#strings.isEmpty(user.profilePicture)
                                    ? 'https://t4.ftcdn.net/jpg/09/43/48/93/360_F_943489384_zq3u5kkefFjPY3liE6t81KrX8W3lvxSz.jpg'
                                    : user.profilePicture}" alt="Profile Avatar">
                            </div>
                            <h3 class="profile-name" th:text="${user.username}"></h3>
                            <p class="profile-email" th:text="${user.email}"></p>
                            <button class="status-button active" th:if="${user.isActive()}">ACTIVE</button>
                            <button class="status-button inactive" th:if="${!user.isActive()}">INACTIVE</button>
                        </div>
                        <nav class="profile-menu">
                            <a th:href="@{/users/profile}" class="profile-menu-item active">
                                <span class="menu-icon">üë§</span>
                                Personal Info
                            </a>
                            <a th:href="@{/notifications}" class="profile-menu-item">
                                <span class="menu-icon">üß†</span>
                                Notifications
                            </a>
                            <a sec:authorize="hasRole('USER')"
                               th:href="@{/users/my-orders}" class="profile-menu-item">
                                <span class="menu-icon">üì¶</span>
                                My Orders
                            </a>
                            <a href="/settings" class="profile-menu-item">
                                <span class="menu-icon">‚öôÔ∏è</span>
                                Settings
                            </a>
                        </nav>
                    </div>
                </aside>

                <div class="profile-content">
                    <div class="profile-info-card card">
                        <div class="card-header">
                            <h2>Personal Information</h2>
                            <form th:action="@{'/users/' + ${user.id} + '/profile'}"
                                  method="GET" th:object="${user}">
                                <button class="edit-button">Edit</button>
                            </form>
                        </div>

                        <div class="profile-info-grid">
                            <div class="info-group">
                                <label>First Name</label>
                                <p th:text="${#strings.isEmpty(user.firstName)
                                    ? 'Edit your profile and add your first name'
                                    : user.firstName}">
                                </p>
                            </div>
                            <div class="info-group">
                                <label>Last Name</label>
                                <p th:text="${#strings.isEmpty(user.lastName)
                                    ? 'Edit your profile and add your last name'
                                    : user.lastName}">
                                </p>
                            </div>
                            <div class="info-group">
                                <label>Email Address</label>
                                <p th:text="${#strings.isEmpty(user.email)
                                    ? 'Edit your profile and add your email'
                                    : user.email}">
                                </p>
                            </div>
                            <div class="info-group">
                                <label>Username</label>
                                <p th:text="${user.username}"></p>
                            </div>
                            <div class="info-group">
                                <label>Date of Birth</label>
                                <p th:text="${#strings.isEmpty(user.birthDate)
                                    ? 'Edit your profile and add your date of birth'
                                    : #temporals.format(user.birthDate, 'dd MMM, yyyy')}">
                                </p>
                            </div>
                            <div class="info-group">
                                <label>Country</label>
                                <p th:text="${#strings.capitalize(#strings.toLowerCase(user.country))}"></p>
                            </div>
                            <div class="info-group full-width">
                                <label>Bio</label>
                                <p th:text="${#strings.isEmpty(user.bio)
                                    ? 'Edit your profile and write your biography'
                                    : user.bio}">
                                </p>
                            </div>
                        </div>
                    </div>

                    <div class="stats-card card">
                        <div class="card-header">
                            <h2>Account Statistics</h2>
                        </div>
                        <div class="stats-grid">
                            <div class="stat-item">
                                <div class="stat-icon">üéµ</div>
                                <div class="stat-content">
                                    <h3>Albums Purchased</h3>
                                    <p class="stat-number" th:text="${totalAlbumsPurchased}">0</p>
                                </div>
                            </div>
                            <div class="stat-item">
                                <div class="stat-icon">üí∞</div>
                                <div class="stat-content">
                                    <h3>Totally Spent</h3>
                                    <p class="stat-number"
                                       th:text="${#numbers.formatDecimal(totalAmountSpent, 1, 2)} + ' ‚Ç¨'">
                                    </p>
                                </div>
                            </div>
                            <div class="stat-item">
                                <div class="stat-icon">‚ù§Ô∏è</div>
                                <div class="stat-content">
                                    <h3>Wishlist Items</h3>
                                    <p class="stat-number">0</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="recent-activity-card card">
                        <div class="card-header">
                            <h2>Recent Activity</h2>
                            <a href="/my-orders" class="view-all-link">View All</a>
                        </div>
                        <div class="activity-list">
                            <div class="activity-item">
                                <div class="activity-icon">üõí</div>
                                <div class="activity-content">
                                    <h4>Purchase Completed</h4>
                                    <p>Midnight Dreams by The Night Owls</p>
                                    <span class="activity-date">2 days ago</span>
                                </div>
                            </div>
                            <div class="activity-item">
                                <div class="activity-icon">‚≠ê</div>
                                <div class="activity-content">
                                    <h4>Review Added</h4>
                                    <p>Rated "Electric Pulse" 5 stars</p>
                                    <span class="activity-date">1 week ago</span>
                                </div>
                            </div>
                            <div class="activity-item">
                                <div class="activity-icon">‚ù§Ô∏è</div>
                                <div class="activity-content">
                                    <h4>Added to Wishlist</h4>
                                    <p>Jazz Fusion by Modern Jazz Collective</p>
                                    <span class="activity-date">2 weeks ago</span>
                                </div>
                            </div>
                            <div class="activity-item">
                                <div class="activity-icon">üéµ</div>
                                <div class="activity-content">
                                    <h4>Download Completed</h4>
                                    <p>Acoustic Stories by Folk Masters</p>
                                    <span class="activity-date">3 weeks ago</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
</main>

<th:block th:replace="~{fragments/footer :: site-footer}"></th:block>

</body>

</html>
